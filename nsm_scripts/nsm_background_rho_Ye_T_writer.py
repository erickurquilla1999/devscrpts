'''
Created by Erick Urquilla, Department of Physics and Astronomy, University of Tennessee, Knoxville.
This script is used to generate an HDF5 file that contains background matter information: rho (density), Yâ‚‘ (electron fraction), and T (temperature). 
The HDF5 file generated by this script will be used as input for background matter quantities in EMU.
'''

import numpy as np
import h5py

# EMU grid parameters
ncellsx = 10 # scalar, number of cells in x-direction
ncellsy = 10 # scalar, number of cells in y-direction
ncellsz = 10 # scalar, number of cells in z-direction
xmin = -5.0 #cm 
xmax =  5.0 #cm 
ymin = -5.0 #cm 
ymax =  5.0 #cm 
zmin = -5.0 #cm 
zmax =  5.0 #cm 
dx = 1.0 #cm 
dy = 1.0 #cm 
dz = 1.0 #cm 
rho = np.full( ( ncellsx, ncellsy, ncellsz ), 0.1 ) # array of size (ncellsx, ncellsy, ncellsz)
T = np.full( ( ncellsx, ncellsy, ncellsz ), 0.1 ) # array of size (ncellsx, ncellsy, ncellsz)
Ye = np.full( ( ncellsx, ncellsy, ncellsz ), 0.1 ) # array of size (ncellsx, ncellsy, ncellsz)

# Write hdf5 file with all the data
with h5py.File('rho_Ye_T.hdf5', 'w') as hdf:
    hdf.create_dataset("ncellsx", data=ncellsx)
    hdf.create_dataset("ncellsy", data=ncellsy)
    hdf.create_dataset("ncellsz", data=ncellsz)
    hdf.create_dataset("xmin", data=xmin)
    hdf.create_dataset("xmax", data=xmax)
    hdf.create_dataset("ymin", data=ymin)
    hdf.create_dataset("ymax", data=ymax)
    hdf.create_dataset("zmin", data=zmin)
    hdf.create_dataset("zmax", data=zmax)
    hdf.create_dataset("dx", data=dx)
    hdf.create_dataset("dy", data=dy)
    hdf.create_dataset("dz", data=dz)
    hdf.create_dataset("rho", data=rho)
    hdf.create_dataset("T", data=T)
    hdf.create_dataset("Ye", data=Ye)